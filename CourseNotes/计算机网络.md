# 第一章 概述

## 互联网的前身

ARPANET

## 互联网的主要功能

把许多网络通过路由器接在一起

## 几种数据交换技术和他们的特点

### 电路交换（面向连接交换）

建立连接（占用通话资源）→通过（一直占用通信资源）→释放连接（归还通信资源）

#### 特点

在通过的全部时间内，通话的两个用户始终占用端到端的通信资源。

#### **缺点**

线路的传输效率低

### 报文交换

#### 特点

- 先将整个报文传送到相邻结点，全部存储下来以后查找转发表，转发到下一个结点

- 不预先分配传输带宽

### 分组交换

采用**存储转发**技术，将报文分组，每个分组称为**包**，通过路由器来进行分组交换

#### 特点

单个分组传送到相邻结点，存储下来以后查找转发表，转发到下一个结点

## 网络的分类方式

### 按照网络作用范围分类

1. 广域网（WAN）
2. 城域网（MAN）
3. 局域网（LAN）
4. 个人局域网（PAN）

### 按照网络的使用者分类

1. 公用网
2. 专用网

## 网络的体系结构

### 网络协议三要素

1. 语法：数据与控制信息的结构或格式
2. 语义：即需要发出盒中控制信息，完成何种动作以及做出何种响应
3. 同步：即时间实现顺序的详细说明

### 网络的体系结构

1. 应用层（报文）
2. 运输层：TCP（报文段），UDP（用户数据报）
3. 网络层（包）
4. 数据链路层（帧）
5. 物理层（比特）

# 第二章 物理层

## 基本概念

1. 机械特征：指明接口所用接线器的各种规程
2. 电器特征：指明接口电缆的各条线上出现的电压的范围
3. 功能特征：指明某条先上出现某一电平的电压的意义
4. 过程特征：指明对于不同功能的各种可能事件的出现顺序

## 基带信号调制方法

### 基带调制（编码）

将波形进行变换，能够与信道特征相适应

### 带通调制

将信号频率范围搬移到较高的频段

#### 方法

1. 调幅（振幅随着基带数字信号而变化）
2. 调频（频率随着基带数字信号而变化）
3. 调相（载波初始相位随着基带数字信号而变化）

## 香农公式

$$C=Wlog_2(1+S/N)$$

$C:$信道的极限传输速率

$W:$信道的带宽（$Hz$）

$S:$信道所传信号的平均功率

$N:$信道内部的高斯噪声功率

### 公式表明

信道的带宽或者信道中信噪比越大，信息的极限传输速率越高。

## CDMA

$a·b=\frac{1}{m}\sum_{i=1}^ma_ib_i$

$S$代表站$S$的码片向量

$T$代表站$T$的码片向量

$S$和$T$相互正交，即$S·T=0$

$S·S=1$

$T·T=1$

$m_1$数据进入$S$基站，那么数据就变为$m_1·S$

$m_2$数据进入$T$基站，那么数据就变为$m_2·T$

最后可以通过这个方法得到不同基站的数据：$(m_1·S+m_2·T)·S=m_1$

- 结果为1说明发送1
- 结果为-1说明发送0
- 结果为0说明没有发送

## 物理层设备

集线器

# 第三章 数据链路层

## 三个基本问题

### 封装成帧

在一个数据的前后添加首部和尾部，首部尾部最重要的是**帧定界（SOU、EOT）**

### 透明传输

采用有效方法解决数据中出现了和帧界定符一样的比特组合。

字节填充法：在数据中的**SOU或者EOT**前面加入转义字符**ESC**

### 差错检测

#### CRC循环冗余校验

设添加$n$位冗余码

先将数据$M$进行二进制的模2运算（$2^n*M$即在$M$后面添加$n$个$0$）

再除以$n+1$位的素数$P$（进行异或运算，相同→0，不同→1），得到商为$Q$余数为$R(n位)$

将$Q$作为冗余码拼接（加上，因为模2以后，后$n$位为0，所以可以理解为拼接）在数据后面发送

接收方再将整个数据去除以余数，如果余数为0，那么说明数据基本没问题

## 点对点协议PPP

### 特点

-  互联网用户通常需要连接到某个 ISP 之后才能接入到互联网，PPP 协议是用户计算机和 ISP 进行通信时所使用的数据链路层协议 

### 帧格式

| F               | A       | C       | 协议        | 信息部分   | FCS    | F               |
| --------------- | ------- | ------- | ----------- | ---------- | ------ | --------------- |
| 0x7E标志字段(2) | 地址(1) | 控制(1) | 上层协议(2) | $\leq1500$ | CRC(2) | 0x7E标志字段(1) |

### 工作状态

1. 个人电脑向ISP发送链路控制协议LCP分组（封装成多个PPP帧）
2. 网络控制协议NCP给电脑分配IP地址
3. NCP释放网络层连接，收回IP
4. LCP释放链路层连接
5. 释放物理层连接

## 局域网的数据链路层

### 网络的拓扑

- 星形网
- 环形网
- 总线网

### 数据链路层的两个子层

- 逻辑链路控制(LLC)子层（纠错，现在一般将纠错放在运输层）
- 媒体接入控制(MAC)子层
-  概要: 与接入到传输媒体有关的内容都放在 MAC子层，而 LLC 子层则与传输媒体无关，不管采用何种协议的局域网对 LLC 子层来说都是透明的 所以以后一般不考虑 LLC 子层 

### CSMA/CD协议

意思：载波监听多点接入/差错检测

#### 多点接入：

总线型网络，许多计算机以多点接入的方式连接在一起

#### 载波监听

站点一直监测信道

#### 碰撞检测

边发送边监听，一旦发现了碰撞，就等待一段随机时间再重新发送

$2t$时间内没有碰撞就说明信道空闲（$t$为单程端到端的传播时延），$2t$也被称为**争用期**，也被称为**碰撞窗口**

规定凡是长度小于64字节的帧都是由于冲突而异常中止的无效帧

##### 截断二进制指数退避

1. 从离散的整数集合$[0,1,...,(2^k-1)]$中随机取一个数，记为$r$，重传就推后$r$倍的争用期。

   $k=Min[重传次数,10]$

2. 当重传16次都不能成功的时候，就丢弃该帧，并向高层报告。

## 以太网

### 以太网特点

1. 尽最大努力交付，不可靠
2. 纠错由高层实现，检测到错误就直接丢弃
3. 采用曼彻斯特编码

### 以太网的信道利用率

帧本身发送时间为$T_0$

争用期为$2t$

发送一帧的时间为$T_0+2t$

所以极限信道利用率$S_{max}=\frac{T_0}{T_0+t}=\frac{1}{1+a}$

- $S_{max}$的意义在于只有当$a$远小于1才能尽可能提高信道利用率

### 以太网的Mac层

- Mac地址为48位的全球地址

- 帧的类型：

1. 单播帧（一对一）
2. 广播帧（一对全体）
3. 多播帧（一对多）

### 以太网帧格式

| 目的地址 | 源地址 | 类型 | 数据    | FSC    |
| -------- | ------ | ---- | ------- | ------ |
| 6        | 6      | 2    | 46-1500 | 校验 4 |

- 如果数据长度过小需要填充
- FSC采用CRC校验

### 扩展以太网

#### 物理层扩展以太网（总线型）

**使用CSMA/CD协议，半双工工作**

- 多个集线器连成更大的局域网
  - 集线器组成的更大局域网都在一个碰撞域中
    - 优点
      - 使原来属于不同碰撞域的局域网上的计算机能够进行跨碰撞域通信
      - 扩大了局域网的地理范围
    - 缺点
      - 碰撞域增大，但是总吞吐量并没有提高
      - 如果不同的碰撞域使用了不同的以太网技术，那么就不能用集线器把他们连起来

#### 链路层扩展以太网（星形）

- 网桥，工作在链路层，根据帧的目的MAC查找地址表再进行转发，在转发帧之前执行CSMA/CD协议
  - 优点
    -  过滤通信量。 
    - 扩大了物理范围。
    - 提高了可靠性。
    - 可互连不同物理层、不同 MAC 子层和不同速率（如10 Mb/s 和 100 Mb/s 以太网）的局域网。
  - 缺点
    - 存储转发增加了时延。
    - 在MAC 子层并没有流量控制功能。
    - 具有不同 MAC 子层的网段桥接在一起时时延更大。
    - 网桥只适合于用户数不太多(不超过几百个)和通信量不太大的局域网，否则有时还会因传播过多的广播信息而产生网络拥塞。这就是所谓的广播风暴。
- 路由器，**不使用CSMA/CD协议，全双工工作**
  - 具有自学习能力，不需要手动配置交换表，交换表中存储MAC地址到端口的映射。
  - 工作流程
    - A给B发送一个帧（此时路由器中都没有A,B的映射，若有映射则第二步就不需要广播，直接通过映射转发即可）
    - A的数据进入路由器，路由器再路由表中存储A的映射，同时广播该帧
    - C,D收到该帧丢弃，B收下这个帧（过滤）

### 虚拟局域网

#### 概念

虚拟出很多小的局域网，将网络隔开，各个VLAN不能通过MAC访问，只能通过IP

#### 特点

- 不同的VLAN属于不同的广播域，可避免广播风暴
- 一个VLAN对应一个子网段