Python有三种解析式语法糖

- 列表解析式
- 集合解析式
- 字典解析式

# 一.列表解析式

## 1.1 普通版

> `[ expression for i in iterable ]`

如，要得到1-10每个数组算数平方根组成的列表

- 使用`for`循环

  ```python
  lst = []
  for i in range(1, 11):
      i = i ** 0.5 #不用pow()是因为这样计算比较快
      lst.append(i) 
  ```

- 使用列表解析式

  ```python
  lst = [ i**0.5 for i in range(1,11) ]
  ```

## 1.2 进阶版

> `[ expression for i in iterable if… for j in iterable if… …]`

如，得到5以内单数和5以内双数组成的所有二元组，然后把这些元组放在一个列表总

- 使用`for`循环

  ```python
  lst = []
  for i in range(1,6):
    if i % 2 == 0:
        continue
    for j in range(1,6):
        if j % 2 == 0:
            lst.append((i,j))
  ```

  ```shell
  lst
  [(1, 2), (1, 4), (3, 2), (3, 4), (5, 2), (5, 4)]
  ```

- 使用列表解析式

  ```python
  [(i,j) for i in range(1,6) if i % 2 for j in range(1,6) if not j % 2]
  ```

需要注意的是列表解析式不能用`elif`，但是能使用`else`

# 二.集合解析式

用法与列表解析式一样，但是`[]`换成了`{}`

集合解析式能够自动去重

```python
{i for i in [1,1,1,1,1,1]} # {1}
```

# 三.字典解析式

用法和前两者也一样，只使用`{}`包裹，而且前面的`expression`得是`key:value`的形式

```python
{i:[j] for i in range(3) for j in 'abc'}
# {0: ['c'], 1: ['c'], 2: ['c']}

#注意key是去重的，所以第一个循环的元素带入第二个循环时，会与第二个循环的最后一个元素组成key:value
```

`key`必须可hash，但是`value`不需要hashable，所以`value`可以用可变的数据结构